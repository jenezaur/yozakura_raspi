

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>rpi.bitfields &mdash; Yozakura 1.0 RC documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Yozakura 1.0 RC documentation" href="../../index.html"/>
        <link rel="up" title="Module code" href="../index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="../../index.html" class="icon icon-home"> Yozakura
        

        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorial.html">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../setup.html">Hardware and Software Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../setup.html#environment-setup">Environment setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../setup.html#ubuntu-setup">Ubuntu setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../setup.html#raspbian-setup">Raspbian setup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../setup.html#peripherals">Peripherals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../setup.html#contec">CONTEC</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../setup.html#contec-station-connected-to-base-station">CONTEC station (connected to base station)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup.html#contec-access-point-connected-to-rpi">CONTEC access point (connected to RPi)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../setup.html#cameras">Cameras</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../setup.html#ai-ball-access-point-elecom">Ai-Ball access point (elecom)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../setup.html#camera-ip-addresses">Camera IP addresses</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../setup.html#urg-ust-10lx">URG (UST-10LX)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../setup.html#hardware-setup">Hardware setup</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../setup.html#wiring">Wiring</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../setup.html#raspberry-pi">Raspberry Pi</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">Technical Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../common.html">common package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../common.html#module-common">Module contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common.html#module-common.exceptions">common.exceptions module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../common.html#module-common.functions">common.functions module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../opstn.html">opstn package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../opstn.html#module-opstn">Module contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../opstn.html#module-opstn.controller">opstn.controller module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../opstn.html#module-opstn.server">opstn.server module</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../rpi.html">rpi package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../rpi.html#module-rpi">Module contents</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rpi.html#module-rpi.bitfields">rpi.bitfields module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rpi.html#module-rpi.client">rpi.client module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rpi.html#module-rpi.devices">rpi.devices module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rpi.html#rpi-mbed-module">rpi.mbed module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../rpi.html#module-rpi.motor">rpi.motor module</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Yozakura</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../index.html">Module code</a> &raquo;</li>
      
    <li>rpi.bitfields</li>
      <li class="wy-breadcrumbs-aside">
        
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <h1>Source code for rpi.bitfields</h1><div class="highlight"><pre>
<span class="c"># (C) 2015  Kyoto University Mechatronics Laboratory</span>
<span class="c"># Released under the GNU General Public License, version 3</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Provide bitfields for Yozakura.</span>

<span class="sd">A bitfield is a structure used to store neighbouring bits where each set of</span>
<span class="sd">bits, and individual bits, can be addressed. Yozakura uses them to represent</span>
<span class="sd">flags, or a packed bit.</span>

<span class="sd">These bitfields typically fit into either a single byte, or a word. They allow</span>
<span class="sd">easy-to-use bit manipulation, and help prevent manipulation mistakes.</span>

<span class="sd">In Yozakura, we use both the structures holding the named bits themselves, as</span>
<span class="sd">well as unions which allow us to address the full byte or word at one time.</span>
<span class="sd">This makes it easy to store data simultaneously, or to transmit it.</span>

<span class="sd">The structure needs _fields_ to be filled as a list of 2-tuples containing</span>
<span class="sd">the field name and the type. Optionally, you can add a third entry to the</span>
<span class="sd">tuple containing the number of bits to be used.</span>

<span class="sd">Examples</span>
<span class="sd">--------</span>
<span class="sd">These examples use MotorPacket, defined below, to illustrate how bitfields</span>
<span class="sd">work, and to compare them to bit manipulation, which you might already know.</span>

<span class="sd">Move motor 1 (0b01) in reverse at a speed of 16/31 of full speed. The</span>
<span class="sd">resulting byte should contain ``0b01110000``, which has an ascii value of</span>
<span class="sd">&quot;p&quot;.</span>

<span class="sd">&gt;&gt;&gt; packet = MotorPacket()</span>
<span class="sd">&gt;&gt;&gt; packet.motor_id = 1</span>
<span class="sd">&gt;&gt;&gt; packet.negative = 1</span>
<span class="sd">&gt;&gt;&gt; packet.speed = 16</span>
<span class="sd">&gt;&gt;&gt; chr(packet.as_byte)</span>
<span class="sd">&#39;p&#39;</span>
<span class="sd">&gt;&gt;&gt; # Get each item separately.</span>
<span class="sd">&gt;&gt;&gt; packet.motor_id</span>
<span class="sd">1</span>
<span class="sd">&gt;&gt;&gt; packet.negative</span>
<span class="sd">1</span>
<span class="sd">&gt;&gt;&gt; packet.speed</span>
<span class="sd">16</span>

<span class="sd">Since the size of the fields were defined in `_MotorPacketBits`, we can set each</span>
<span class="sd">portion individually without needing to perform bit manipulation. What we did is</span>
<span class="sd">the equivalent of:</span>

<span class="sd">&gt;&gt;&gt; motor_id = 1 &lt;&lt; 6</span>
<span class="sd">&gt;&gt;&gt; negative = 1 &lt;&lt; 5</span>
<span class="sd">&gt;&gt;&gt; speed = 16</span>
<span class="sd">&gt;&gt;&gt; packet = motor_id + negative + speed</span>
<span class="sd">&gt;&gt;&gt; chr(packet)</span>
<span class="sd">&#39;p&#39;</span>
<span class="sd">&gt;&gt;&gt; # Get each item separately.</span>
<span class="sd">&gt;&gt;&gt; packet &gt;&gt; 6  # motor_id</span>
<span class="sd">1</span>
<span class="sd">&gt;&gt;&gt; (packet &gt;&gt; 5) &amp; (1 &lt;&lt; 0)  # negative</span>
<span class="sd">1</span>
<span class="sd">&gt;&gt;&gt; packet &amp; 0b11111  # speed</span>
<span class="sd">16</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">ctypes</span>


<span class="c"># Used by the arm mbed</span>
<span class="k">class</span> <span class="nc">_ArmPacketBits</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">LittleEndianStructure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The bits for the packet sent to the arm mbed.</span>

<span class="sd">    Note that the mbed&#39;s processor is little endian, which is why a</span>
<span class="sd">    `LittleEndianStructure` is used.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    ArmPacket</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;mode&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint8</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&quot;linear&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint8</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&quot;pitch&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint8</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&quot;yaw&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint8</span><span class="p">,</span> <span class="mi">2</span><span class="p">)]</span>


<div class="viewcode-block" id="ArmPacket"><a class="viewcode-back" href="../../rpi.html#rpi.bitfields.ArmPacket">[docs]</a><span class="k">class</span> <span class="nc">ArmPacket</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">Union</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The packet sent to the arm mbed.</span>

<span class="sd">    When the Raspberry Pi is connected to the mbed, arm control information</span>
<span class="sd">    is encoded as a single byte.</span>

<span class="sd">    Using a union allows us to transmit the full byte to the mbed by using</span>
<span class="sd">    `packet.as_byte`, and ensures that it would be exactly eight bits long.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    mode : 2 bits</span>
<span class="sd">        The control mode of the arm.</span>
<span class="sd">    linear : 2 bits</span>
<span class="sd">        The direction in which to move the linear extension servo of the arm.</span>
<span class="sd">    pitch : 2 bits</span>
<span class="sd">        The direction in which to move the pitch servo of the arm.</span>
<span class="sd">    yaw : 2 bits</span>
<span class="sd">        The direction in which to move the yaw servo of the arm.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Anonymous usage is the bitfield, `b`. The full byte can be accessed via</span>
<span class="sd">    `as_byte`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="n">_ArmPacketBits</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&quot;as_byte&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint8</span><span class="p">)]</span>

    <span class="n">_anonymous_</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">)</span>


<span class="c"># Used in rpi.motors</span></div>
<span class="k">class</span> <span class="nc">_MotorPacketBits</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">LittleEndianStructure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The bits for the packet sent to the motors.</span>

<span class="sd">    Note that the mbed&#39;s processor is little endian, which is why a</span>
<span class="sd">    `LittleEndianStructure` is used.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    MotorPacket</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;motor_id&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint8</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&quot;negative&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint8</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&quot;speed&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint8</span><span class="p">,</span> <span class="mi">5</span><span class="p">)]</span>


<div class="viewcode-block" id="MotorPacket"><a class="viewcode-back" href="../../rpi.html#rpi.bitfields.MotorPacket">[docs]</a><span class="k">class</span> <span class="nc">MotorPacket</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">Union</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The packet sent to the motors.</span>

<span class="sd">    When the Raspberry Pi is connected to the mbed, motor control information</span>
<span class="sd">    is encoded as a single byte.</span>

<span class="sd">    Using a union allows us to transmit the full byte to the mbed by using</span>
<span class="sd">    `packet.as_byte`, and ensures that it would be exactly eight bits long.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    motor_id : 2 bits</span>
<span class="sd">        The motor ID. Can range between 0 and 3.</span>
<span class="sd">    negative : bool</span>
<span class="sd">        Whether the speed is negative.</span>
<span class="sd">    speed : 5 bits</span>
<span class="sd">        The magnitude of the speed. Can range between 0 and 31.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Anonymous usage is the bitfield, `b`. The full byte can be accessed via</span>
<span class="sd">    `as_byte`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="n">_MotorPacketBits</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&quot;as_byte&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint8</span><span class="p">)]</span>

    <span class="n">_anonymous_</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">)</span>


<span class="c"># Used in rpi.devices.CurrentSensor</span></div>
<span class="k">class</span> <span class="nc">_CurrentConfigurationBits</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">Structure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The bits for the configuration register of the INA226 `CurrentSensor`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    CurrentConfiguration</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;reset&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>     <span class="c"># Reset bit</span>
                <span class="p">(</span><span class="s">&quot;empty&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&quot;avg&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>       <span class="c"># Averaging mode</span>
                <span class="p">(</span><span class="s">&quot;bus_ct&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>    <span class="c"># Bus voltage conv. time</span>
                <span class="p">(</span><span class="s">&quot;shunt_ct&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span>  <span class="c"># Shunt voltage conv. time</span>
                <span class="p">(</span><span class="s">&quot;mode&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">3</span><span class="p">)]</span>      <span class="c"># Operating mode</span>


<div class="viewcode-block" id="CurrentConfiguration"><a class="viewcode-back" href="../../rpi.html#rpi.bitfields.CurrentConfiguration">[docs]</a><span class="k">class</span> <span class="nc">CurrentConfiguration</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">Union</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The union for the configuration register of `CurrentSensor`.</span>

<span class="sd">    The current sensor used here is the Texas Instruments INA226 Current/Power</span>
<span class="sd">    Monitor. The configuration register details are shown on pages 18 and 19</span>
<span class="sd">    of the datasheet. [#]_</span>

<span class="sd">    The Configuration Register settings control the operating modes for the</span>
<span class="sd">    INA226. This register controls the conversion time settings for both the</span>
<span class="sd">    shunt and bus voltage measurements as well as the averaging mode used. The</span>
<span class="sd">    operating mode that controls what signals are selected to be measured is</span>
<span class="sd">    also programmed in the Configuration Register.</span>

<span class="sd">    The Configuration Register can be read from at any time without impacting</span>
<span class="sd">    or affecting the device settings or a conversion in progress. Writing to</span>
<span class="sd">    the Configuration Register will halt any conversion in progress until the</span>
<span class="sd">    write sequence is completed resulting in a new conversion starting based</span>
<span class="sd">    on the new contents of the Configuration Register. This prevents any</span>
<span class="sd">    uncertainty in the conditions used for the next completed conversion.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    reset : bool</span>
<span class="sd">        Whether to reset.</span>
<span class="sd">    empty : 3 bits</span>
<span class="sd">        Not used.</span>
<span class="sd">    avg : 3 bits</span>
<span class="sd">        Averaging mode. Can range between 0 and 7.</span>
<span class="sd">    bus_ct : 3 bits</span>
<span class="sd">        Bus voltage conversion time. Can range between 0 and 7.</span>
<span class="sd">    shunt_ct : 3 bits</span>
<span class="sd">        Shunt voltage conversion time. Can range between 0 and 7.</span>
<span class="sd">    mode : 3 bits</span>
<span class="sd">        Operating mode. Can range between 0 and 7.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Anonymous usage is the bitfield, `b`. The full byte can be accessed via</span>
<span class="sd">    `as_byte`.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [#] Texas Instruments, INA 226 datasheet.</span>
<span class="sd">           http://www.ti.com/lit/ds/symlink/ina226.pdf</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="n">_CurrentConfigurationBits</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&quot;as_byte&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">)]</span>

    <span class="n">_anonymous_</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">)</span>

</div>
<span class="k">class</span> <span class="nc">_CurrentAlertsFlags</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">Structure</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The bits for the Mask/Enable register of the INA226 `CurrentSensor`.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    CurrentAlerts</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;shunt_ol&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>    <span class="c"># Shunt overvolt</span>
                <span class="p">(</span><span class="s">&quot;shunt_ul&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>    <span class="c"># Shunt undervolt</span>
                <span class="p">(</span><span class="s">&quot;bus_ol&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>      <span class="c"># Bus overvolt</span>
                <span class="p">(</span><span class="s">&quot;bus_ul&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>      <span class="c"># Bus undervolt</span>
                <span class="p">(</span><span class="s">&quot;power_ol&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>    <span class="c"># Power over limit</span>
                <span class="p">(</span><span class="s">&quot;conv_watch&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c"># Conversion ready</span>
                <span class="p">(</span><span class="s">&quot;empty&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>       <span class="c"># Not used</span>
                <span class="p">(</span><span class="s">&quot;alert_func&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>  <span class="c"># Alert function flag</span>
                <span class="p">(</span><span class="s">&quot;conv_flag&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>   <span class="c"># Conversion ready flag</span>
                <span class="p">(</span><span class="s">&quot;overflow&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>    <span class="c"># Math overflow flag</span>
                <span class="p">(</span><span class="s">&quot;invert&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>      <span class="c"># Alert polarity bit</span>
                <span class="p">(</span><span class="s">&quot;latch&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>       <span class="c"># Alert latch enable</span>


<div class="viewcode-block" id="CurrentAlerts"><a class="viewcode-back" href="../../rpi.html#rpi.bitfields.CurrentAlerts">[docs]</a><span class="k">class</span> <span class="nc">CurrentAlerts</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">Union</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The union for the Mask/Enable register of `CurrentSensor`.</span>

<span class="sd">    The current sensor used here is the Texas Instruments INA226 Current/Power</span>
<span class="sd">    Monitor. The Mask/Enable register details are shown on pages 21 and 22 of</span>
<span class="sd">    the datasheet. [#]_</span>

<span class="sd">    The Mask/Enable Register selects the function that is enabled to control</span>
<span class="sd">    the Alert pin, as well as how that pin functions. If multiple functions</span>
<span class="sd">    are enabled, the highest significant bit position Alert Function (D11-D15)</span>
<span class="sd">    takes priority and responds to the Alert Limit register.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    shunt_ol : bool</span>
<span class="sd">        Whether to trigger an alert when the shunt voltage goes over the limit.</span>
<span class="sd">    shunt_ul : bool</span>
<span class="sd">        Whether to trigger an alert when the shunt voltage goes below the</span>
<span class="sd">        limit.</span>
<span class="sd">    bus_ol : bool</span>
<span class="sd">        Whether to trigger an alert when the bus voltage goes over the limit.</span>
<span class="sd">    bus_ul : bool</span>
<span class="sd">        Whether to trigger an alert when the bus voltage goes under the limit.</span>
<span class="sd">    power_ol : bool</span>
<span class="sd">        Whether to trigger an alert when the power goes over the limit.</span>
<span class="sd">    conv_watch : bool</span>
<span class="sd">        Whether to trigger an alert when a conversion is ready.</span>
<span class="sd">    empty : 5 bits</span>
<span class="sd">        Not used.</span>
<span class="sd">    alert_func : bool</span>
<span class="sd">        Whether the alert was triggered by an alert function.</span>
<span class="sd">        (`shunt_ol`, `shunt_ul`, `bus_ol`, `bus_ul`, `power_ol`)</span>
<span class="sd">    conv_flag : bool</span>
<span class="sd">        Whether the alert was triggered by a conversion becoming ready.</span>
<span class="sd">    overflow : bool</span>
<span class="sd">        Whether the alert was triggered by a math overflow.</span>
<span class="sd">    invert : bool</span>
<span class="sd">        Whether to invert the alert polarity. Default is ``False``. If</span>
<span class="sd">        ``True``, the alert line would be ``HIGH`` when active.</span>
<span class="sd">    latch : bool</span>
<span class="sd">        Whether to latch the alert and flag bits, even after the fault has</span>
<span class="sd">        cleared. Default is ``False``.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    Anonymous usage is the bitfield, `b`. The full byte can be accessed via</span>
<span class="sd">    `as_byte`.</span>

<span class="sd">    References</span>
<span class="sd">    ----------</span>
<span class="sd">    .. [#] Texas Instruments, INA226 datasheet.</span>
<span class="sd">            http://www.ti.com/lit/ds/symlink/ina226.pdf</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_fields_</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&quot;b&quot;</span><span class="p">,</span> <span class="n">_CurrentAlertsFlags</span><span class="p">),</span>
                <span class="p">(</span><span class="s">&quot;as_byte&quot;</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint16</span><span class="p">)]</span>

    <span class="n">_anonymous_</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;b&quot;</span><span class="p">)</span></div>
</pre></div>

          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Kyoto University Mechatronics Laboratory.
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0 RC',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>